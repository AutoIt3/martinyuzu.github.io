---
layout:     post
title:      航班选择模型简介
subtitle:   FlightAI航空智能大数据 
date:       2019-10-10
author:     MartinYu
header-img: img/home-bg.jpg
catalog: true
tags:
    - 机票
    - 技术

---

 航班选择模型简介 

随着民航市场的逐渐增长，选择飞机出行的旅客日渐增多，国内航司在航线上的航班供给也愈加丰富。激烈的竞争环境为航空公司带来了一系列的挑战。旅客在预订航班时，在选定了出发与到达城市后，往往面临着多个航班的选择。

因此，理解旅客在这种情况下如何做出选择，有助于航空公司更好地决策，这也是航空公司收益管理中的重要课题。旅客最终预订决策受到如航班时刻、价格、航司品牌等因素影响，我们根据前述因素，建立航班选择模型，探究各个影响因素的重要性。

![img](/martinyuzu.github.io/_posts/2019-10-10- 航班选择模型简介/0.png)

模型介绍

Model Introduction

一条航线上通常有多个航班执飞，而影响用户最终航班选择的因素则复杂多样。其中，主要的影响因素一般为机票票价以及航班起飞时刻；除此之外，提前预订期，航空公司品牌，起飞日期所在的星期数也不容忽视。为探究此问题，我们利用用户预订数据构建航班选择二分类模型。此模型可以实现，在用户提前预订期处于1-15天之间内，预测特定航线上用户选择购买某个航班的概率。模型预测效果良好，AUC大于0.85.

特征分析

Feature Analysis

机票票价和航班起飞时刻是用户选择航班的主要因素，除这两个特征之外，我们还引入航司品牌和航线热度等信息，并衍生出了一些交叉特征。为更好展示各因素与航班被选概率之间的关系，我们将分别从价差、时刻、提前预订天数以及区域等因素出发，分析各因素对用户航班选择的影响**。**

一、价格差与选择率

机票价格是影响用户选择航班的最重要因素之一，除了价格本身之外，航班与竞飞航班的价格差等价格衍生因素也是决定用户选择的关键。如下图所示，对某航班而言，当其他条件固定不变时，目标航班的票价与竞飞航班的价格差越大，用户购买目标航班的概率就越低**。**

![img](/martinyuzu.github.io/_posts/2019-10-10- 航班选择模型简介/640?wx_fmt=png&tp=png&wxfrom=5&wx_lazy=1&wx_co=1.png)

二.提前预订天数与选择率

而后我们探究了某航线提前预订天数与购买概率的关系。从下图可知，当其他条件一定时，起飞日当天或距离起飞日8天及以上时，航班对用户吸引力欠佳，此时购买率也会偏低；而距离起飞日期1-7天时，此时航班购买概率较高。

![img](/martinyuzu.github.io/_posts/2019-10-10- 航班选择模型简介/11.png)

三、时刻差与价格差结合与选择率

除了分析单一因素对航班选择的作用外，我们还探究多个因素相结合对用户的影响。我们选取某特定航班作为样本，对该目标航班和竞飞航班的时刻差和价格差进行分段处理，并计算出每个区间的正负样本比率关系。在某一区间里，若正负样本比例大于1，说明目标航班具有一定优势；若比例小于1，则竞飞航班具有一定优势。

从下表中可以看出价格差和时刻差两个因素对用户选择航班的共同作用情况。一个整体趋势是：目标航班起飞时刻相比竞飞航班越晚，航班的价格优势对用户的影响越小。例如，当目标航班与竞飞航班的时刻差在3小时以内时，目标航班仅需要比竞飞航班便宜49元以内就可以对用户产生足够的吸引力；但当目标航班比竞飞航班晚4-9个小时，目标航班的价格优势需要达到110以上才能对用户产生微小的吸引力；另外，当目标航班比竞飞航班早4-9个小时，目标航班即使比竞飞航班贵69-140元，整体来看也还是比竞飞航班更受用户青睐。

![img](/martinyuzu.github.io/_posts/2019-10-10- 航班选择模型简介/2.png)

四、不同航线上航司品牌热度

根据历史样本，航司的品牌热度具有地域性的特点。我们首先按照地理位置划分区域，如东北、华南、华北等，再为所有航司在每个区域的热度进行排名。

如下表所示，A/B/C/D/E五家航司在东北->华南和华南->华东区域上热度排名会有所不同。A航司在东北至华南区域的热度排名第一，但在华南至华东区域的排名热度仅为第四；而D航司在华南至华东区域上热度排名第二，不过在东北至华南区域的热度仅位列第五。鉴于不同区域的用户对各航司的喜好程度不一样，将航司在航段所属区域的影响力作为航班选择模型的特征会有助于提升模型的预测效果。

![img](/martinyuzu.github.io/_posts/2019-10-10- 航班选择模型简介/3.png)

模型训练和效果评估

Model Training & Evaluation

我们选取42条航线的五个月历史数据作为训练集，使用XGBoost进行模型构建。为保证数据的稳定性，避开国内航班换季点和春运时间段。

而后，我们模拟实际生产环境，按照查询日期分割出训练样本和测试样本。训练集和验证集的AUC分别为0.905、0.887，测试集的AUC为0.851，未发生过拟合现象。

如下为模型在测试集上的ROC-AUC曲线。

![img](/martinyuzu.github.io/_posts/2019-10-10- 航班选择模型简介/4.png)

最终，我们按重要性从高到低，展示10个最重要的模型特征，其中最重要的三个特征为航段，航班价格与价格差。

![img](/martinyuzu.github.io/_posts/2019-10-10- 航班选择模型简介/5.png)

我们以上述模型为基础，与某航司合作，在试验航线上协助航司制定出更受用户欢迎的策略，提升了航司收益2-3%。